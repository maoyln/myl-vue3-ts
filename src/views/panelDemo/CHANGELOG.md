# 更新日志

## [5.0.0] - 2026-01-20

### 🎉 重大更新：扩展功能完成

基于设计文档 `泊靠doc/13、panel设计.md` 要求，实现所有扩展功能。

### ✨ 新增功能

#### 停靠侧功能

1. **热区识别（DockZone）**
   - 拖拽时自动检测停靠热区
   - 实时显示半透明预览区域
   - 支持5种停靠位置（left/right/top/bottom/center）
   - 呼吸动画视觉效果

2. **分组拖拽调整**
   - 分组之间添加调整手柄
   - 拖拽手柄动态调整占比
   - 自动归一化确保总占比为100%
   - 限制最小占比10%

3. **占比动态修改**
   - 面板之间添加调整手柄
   - 支持水平/垂直方向调整
   - 悬停显示蓝色线条提示
   - 实时更新布局

#### 悬浮侧功能

4. **zIndex 层级调整**
   - 右上角层级控制工具栏
   - 一键置顶按钮（⬆）
   - 前移/后移一层按钮（↑/↓）
   - 实时显示当前层级数字
   - 最顶层面板特殊标识

5. **标签页跨组拖拽（TabDragInfo）**
   - 标签页支持拖拽移动
   - 跨面板组拖动标签
   - 自动检测插入位置
   - 拖动超过50px自动拆分为新面板
   - 源面板无标签时自动删除

6. **悬浮面板合并/拆分**
   - 支持面板合并（mergePanelGroups）
   - 支持标签拆分（splitTabToNewPanel）
   - 拖拽自动触发拆分
   - 新面板继承原面板尺寸

### 📦 新增文件

- `usePanelManager.ts` (570行)
  - 核心逻辑管理器
  - 热区检测算法
  - 层级管理系统
  - 标签拖拽处理
  - 占比调整计算
  - 面板合并/拆分

- `FEATURES.md`
  - 扩展功能详细说明文档
  - 使用示例
  - API 文档
  - 视觉效果说明

- `CHANGELOG.md`
  - 本文档

### 🔧 修改文件

- `LayoutManagerComponent.vue`
  - 集成 usePanelManager
  - 添加热区预览UI（~50行）
  - 添加层级控制按钮（~30行）
  - 添加占比调整手柄（~40行）
  - 添加标签拖拽处理（~80行）
  - 新增样式（~150行）

- `PanelGroupComponent.vue`
  - 支持标签拖拽事件
  - 添加 tab-drag-start 事件

- `index.ts`
  - 导出 usePanelManager

### 📊 代码统计

| 指标 | V4.0 | V5.0 | 变化 |
|------|------|------|------|
| 组件数量 | 5个 | 5个 | - |
| Composable | 0个 | 1个 | +1 |
| 总代码行数 | ~500行 | ~1270行 | +770行 |
| 核心功能 | 基础布局 | +6个扩展功能 | +6 |

### 🎨 样式更新

- 热区预览动画
- 调整手柄悬停效果
- 层级控制工具栏
- 最顶层面板标识

### ⚡ 性能优化

- 使用 computed 缓存计算结果
- 事件监听自动清理
- 防止内存泄漏

### 🐛 Bug修复

- 修复 TypeScript 类型错误
- 修复 flexDirection 类型问题
- 修复 position 类型问题

---

## [4.0.0] - 2026-01-20

### 🎉 重大重构：展示与布局分离

用户反馈：
> "不管是悬浮还是泊靠，其展示形态都是一样的，至于是悬浮还是泊靠，应该是布局管理器容器层通过json数据控制的"

### ✨ 核心改进

1. **创建统一展示组件**
   - 新增 `PanelContainer.vue`（60行）
   - 停靠和悬浮使用同一个组件
   - 无任何布局逻辑

2. **布局逻辑集中**
   - 重写 `LayoutManagerComponent.vue`
   - 统一管理停靠和悬浮布局
   - 透明拖拽手柄

3. **删除冗余组件**
   - SimpleDockContainer.vue
   - SimpleFloatPanel.vue

### 📊 优化成果

- 组件数量：6个 → 5个（-17%）
- 展示组件代码：295行 → 60行（-80%）
- 总代码量：~700行 → ~500行（-29%）

---

## [3.0.0] - 2026-01-20

### 遵循设计文档架构

- 严格遵循三级分层
- 实现占比布局
- 实现坐标定位
- 视觉统一

---

## [2.0.0] - 2026-01-20

### 统一组件架构

- 创建 UnifiedPanelGroup
- 尝试统一停靠和悬浮

---

## [1.0.0] - 2026-01-20

### 初始版本

- 基础组件创建
- 类型定义
- 配置文件
- 演示Demo

---

**当前版本**: 5.0.0  
**最后更新**: 2026-01-20  
**功能完成度**: 100%
